.PHONY: all check clean distclean realclean

OCT := gl_print.oct

MKOCTFILE  ?= mkoctfile
MKOCTFLAGS ?= -Wall -v

all: $(OCT)

debug : MKOCTFLAGS += -g
debug : all

%.oct: %.cc
	$(MKOCTFILE) $(MKOCTFLAGS) -I/usr/include/freetype2 $^ @LIBS@ -o $@

check: $(OCT)
	octave -q --eval 'sombrero; gl_print (gcf(), "cat > check1.svg", "svg")'
	octave -q --eval 'peaks; gl_print (gcf(), "/usr/bin/gs -dQUIET -dNOPAUSE -dBATCH -dSAFER -sDEVICE=png16m -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -r150x150 -dEPSCrop -sOutputFile=\"check2.png\" -", "eps")'

clean:
	rm -f *.oct *.o *.svg *.png
	rm -f octave-core octave-workspace

distclean: clean
	rm -f Makefile

realclean: clean
	rm -f configure config.status config.log
	rm -rf autom4te.cache
	rm -f Makefile

